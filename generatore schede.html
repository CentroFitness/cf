<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generatore di Schede di Allenamento</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=Oswald:wght@500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #ff4757;
            --primary-light: #ff6b81;
            --primary-dark: #ff0000;
            --secondary: #2f3542;
            --secondary-light: #57606f;
            --accent: #ff6b81;
            --light: #f1f2f6;
            --dark: #1e272e;
            --success: #2ed573;
            --success-light: #7bed9f;
            --warning: #ffa502;
            --warning-light: #ffbe76;
            --info: #1e90ff;
            --info-light: #70a1ff;
        }
        
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Montserrat', sans-serif;
            background-color: #f8f9fa;
            background-image: linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(255,255,255,0.9) 100%), url('https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?q=80&w=2070&auto=format&fit=crop');
            background-size: cover;
            background-attachment: fixed;
            color: var(--dark);
            line-height: 1.6;
            padding: 0;
            margin: 0;
            -webkit-text-size-adjust: 100%;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 15px;
            width: 100%;
        }
        
        header {
            background: linear-gradient(135deg, var(--secondary), var(--dark));
            color: white;
            padding: 20px 0;
            text-align: center;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }
        
        h1, h2, h3, h4 {
            font-family: 'Oswald', sans-serif;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            margin-top: 0;
        }
        
        h1 {
            font-size: clamp(1.8rem, 5vw, 2.8rem);
            margin: 0;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            position: relative;
            padding: 0 10px;
        }
        
        h2 {
            color: var(--secondary);
            font-size: clamp(1.4rem, 4vw, 1.8rem);
            margin-top: 25px;
            border-bottom: 3px solid var(--primary);
            padding-bottom: 8px;
            display: inline-block;
        }
        
        .logo {
            font-size: clamp(1.8rem, 6vw, 3rem);
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
            padding: 0 10px;
        }
        
        .form-container {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(0,0,0,0.1);
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(min(300px, 100%), 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .form-group {
            margin-bottom: 12px;
            position: relative;
        }
        
        label {
            display: block;
            margin-bottom: 6px;
            font-weight: 600;
            color: var(--secondary);
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: clamp(0.9rem, 3vw, 1rem);
        }
        
        input, select {
            width: 100%;
            padding: 12px 15px 12px 35px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: clamp(0.9rem, 3vw, 1rem);
            transition: all 0.3s;
            background-color: #fff;
            -webkit-appearance: none;
        }
        
        .input-icon {
            position: absolute;
            left: 12px;
            top: 38px;
            color: var(--secondary-light);
            font-size: clamp(0.9rem, 3vw, 1rem);
        }
        
        button {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 12px 20px;
            font-size: clamp(0.9rem, 3vw, 1rem);
            font-weight: 600;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin: 8px 8px 0 0;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            width: 100%;
            justify-content: center;
        }
        
        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }
        
        .button-group button {
            width: auto;
            flex: 1 1 auto;
            min-width: 150px;
        }
        
        #scheda {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-top: 25px;
            position: relative;
            border: 1px solid rgba(0,0,0,0.1);
            overflow-x: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            min-width: 600px;
        }
        
        th, td {
            padding: 10px 12px;
            text-align: left;
            font-size: clamp(0.8rem, 3vw, 0.9rem);
        }
        
        th {
            background-color: var(--secondary);
            color: white;
            position: sticky;
            top: 0;
        }
        
        td {
            border-bottom: 1px solid #eee;
        }
        
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        .warmup-stretching {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin: 20px 0;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(0,0,0,0.1);
        }
        
        ul {
            padding-left: 20px;
            list-style-type: none;
            margin: 15px 0;
        }
        
        li {
            margin-bottom: 8px;
            position: relative;
            padding-left: 25px;
            font-size: clamp(0.9rem, 3vw, 1rem);
        }
        
        .social {
            background: var(--secondary);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-top: 30px;
            position: relative;
            overflow: hidden;
        }
        
        .social a {
            color: var(--accent);
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            font-size: clamp(0.9rem, 3vw, 1rem);
        }
        
        .success {
            color: var(--success);
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: clamp(1rem, 4vw, 1.2rem);
        }
        
        .warning {
            color: var(--warning);
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: clamp(0.9rem, 3vw, 1rem);
        }
        
        .highlight-box {
            background: linear-gradient(135deg, #fff5f5, #ffecec);
            border-left: 4px solid var(--primary);
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 6px 6px 0;
            position: relative;
            font-size: clamp(0.9rem, 3vw, 1rem);
        }
        
        .week-title {
            background: linear-gradient(135deg, var(--secondary), var(--dark));
            color: white;
            padding: 8px 12px;
            border-radius: 5px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin: 15px 0 8px;
            font-size: clamp(1rem, 4vw, 1.2rem);
        }
        
        .day-title {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            padding: 6px 12px;
            border-radius: 5px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin: 12px 0 6px;
            font-size: clamp(0.9rem, 3vw, 1.1rem);
        }
        
        .exercise-icon {
            color: var(--primary);
            margin-right: 6px;
            font-size: 0.9em;
        }

        /* Sezione Donazioni */
        .donation-section {
            background: linear-gradient(135deg, #f5f7fa, #e4e8f0);
            border-radius: 10px;
            padding: 25px;
            margin: 40px 0 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border: 1px solid rgba(0,0,0,0.1);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .donation-title {
            color: var(--primary);
            font-size: clamp(1.3rem, 4vw, 1.6rem);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .donation-text {
            margin-bottom: 20px;
            font-size: clamp(0.95rem, 3vw, 1.05rem);
            line-height: 1.6;
        }

        .donation-methods {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
        }

        .donation-method {
            background: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            flex: 1 1 300px;
            max-width: 100%;
            text-align: left;
            border-left: 4px solid var(--primary);
        }

        .donation-method h4 {
            color: var(--secondary);
            margin-top: 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .bank-details {
            font-family: monospace;
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
            margin-top: 10px;
            font-size: 0.9rem;
        }

        .thank-you-message {
            display: none;
            background: var(--success-light);
            color: #155724;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
            border-left: 4px solid var(--success);
        }

        /* Sezione Footer */
        .footer-section {
            background-color: var(--secondary);
            color: white;
            padding: 30px;
            margin-top: 40px;
            border-radius: 10px;
            font-size: 0.9rem;
        }

        .footer-section a {
            color: var(--accent);
            text-decoration: none;
            transition: all 0.3s;
        }

        .footer-section a:hover {
            text-decoration: underline;
            color: var(--primary-light);
        }

        .footer-columns {
            display: flex;
            flex-wrap: wrap;
            gap: 40px;
            margin-bottom: 20px;
        }

        .footer-column {
            flex: 1;
            min-width: 250px;
        }

        .footer-column h4 {
            color: var(--primary);
            margin-top: 0;
            border-bottom: 2px solid var(--primary);
            padding-bottom: 5px;
            display: inline-block;
            font-size: 1.1rem;
        }

        .footer-column p {
            margin-bottom: 10px;
            line-height: 1.6;
        }

        .footer-column strong {
            color: var(--primary-light);
        }

        .copyright {
            text-align: center;
            padding-top: 20px;
            border-top: 1px solid rgba(255,255,255,0.1);
            margin-top: 20px;
            font-size: 0.85rem;
            color: rgba(255,255,255,0.7);
        }
        
        /* Mobile specific styles */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            header {
                padding: 15px 0;
                margin-bottom: 15px;
            }
            
            .form-container, #scheda, .warmup-stretching, .social, .donation-section, .footer-section {
                padding: 15px;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .button-group {
                flex-direction: column;
                gap: 8px;
            }
            
            .button-group button {
                width: 100%;
                min-width: unset;
            }
            
            table {
                font-size: 0.8rem;
            }
            
            th, td {
                padding: 8px 10px;
            }

            .donation-method {
                flex: 1 1 100%;
            }

            .footer-columns {
                flex-direction: column;
                gap: 20px;
            }

            .footer-section {
                padding: 20px 15px;
            }
        }
        
        @media (max-width: 480px) {
            h1 {
                font-size: 1.6rem;
            }
            
            h2 {
                font-size: 1.3rem;
            }
            
            .logo {
                font-size: 1.6rem;
                gap: 5px;
            }
            
            input, select {
                padding: 10px 12px 10px 30px;
            }
            
            .input-icon {
                left: 10px;
                top: 33px;
            }
            
            button {
                padding: 10px 15px;
            }
        }
        
        /* Print styles */
        @media print {
            body {
                background: white;
                font-size: 12pt;
            }
            
            .container {
                padding: 0;
                max-width: 100%;
            }
            
            header, .form-container, .button-group, .social, .donation-section, .footer-section {
                display: none;
            }
            
            #scheda, .warmup-stretching {
                box-shadow: none;
                border: none;
                padding: 0;
                margin: 0 0 20px 0;
                page-break-inside: avoid;
            }
            
            table {
                page-break-inside: auto;
            }
            
            tr {
                page-break-inside: avoid;
                page-break-after: auto;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="logo">A.S.D CENTROFITNESS</div>
            <h1>Generatore di Schede di Allenamento</h1>
            <p>Personalizza la tua scheda di allenamento per le prossime 6 settimane</p>
        </div>
    </header>

    <div class="container">
        <div class="form-container">
            <h2><i class="fas fa-user"></i> Informazioni Personali</h2>
            <div class="form-grid">
                <div class="form-group">
                    <label for="nome"><i class="fas fa-signature"></i> Nome e Cognome</label>
                    <i class="fas fa-user input-icon"></i>
                    <input type="text" id="nome" placeholder="Es. Mario Rossi" required>
                </div>
                
                <div class="form-group">
                    <label for="eta"><i class="fas fa-birthday-cake"></i> Età</label>
                    <i class="fas fa-calendar-alt input-icon"></i>
                    <input type="number" id="eta" min="10" max="100" value="30">
                </div>
                
                <div class="form-group">
                    <label for="genere"><i class="fas fa-venus-mars"></i> Genere</label>
                    <i class="fas fa-user-tag input-icon"></i>
                    <select id="genere">
                        <option value="uomo">Uomo</option>
                        <option value="donna">Donna</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="peso"><i class="fas fa-weight"></i> Peso (kg)</label>
                    <i class="fas fa-weight-hanging input-icon"></i>
                    <input type="number" id="peso" min="30" max="200">
                </div>
                
                <div class="form-group">
                    <label for="altezza"><i class="fas fa-ruler-vertical"></i> Altezza (cm)</label>
                    <i class="fas fa-arrows-alt-v input-icon"></i>
                    <input type="number" id="altezza" min="120" max="250">
                </div>
                
                <div class="form-group">
                    <label for="fisico"><i class="fas fa-tshirt"></i> Tipo di fisico</label>
                    <i class="fas fa-user-shield input-icon"></i>
                    <select id="fisico">
                        <option value="ectomorfo">Ectomorfo</option>
                        <option value="mesomorfo">Mesomorfo</option>
                        <option value="endomorfo">Endomorfo</option>
                    </select>
                </div>
            </div>
            
            <h2><i class="fas fa-dumbbell"></i> Preferenze Allenamento</h2>
            <div class="form-grid">
                <div class="form-group">
                    <label for="tipologia"><i class="fas fa-clipboard-list"></i> Tipologia di scheda</label>
                    <i class="fas fa-tasks input-icon"></i>
                    <select id="tipologia">
                        <option value="classica">Classica</option>
                        <option value="totalbody">Total Body</option>
                        <option value="over60">Over 60</option>
                        <option value="gambe">Solo Gambe</option>
                        <option value="cardio">Solo Cardio</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="giorni"><i class="fas fa-calendar-day"></i> Giorni di allenamento</label>
                    <i class="fas fa-calendar-week input-icon"></i>
                    <select id="giorni">
                        <option value="3">3 giorni</option>
                        <option value="4">4 giorni</option>
                        <option value="5">5 giorni</option>
                        <option value="6" selected>6 giorni</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="obiettivo"><i class="fas fa-bullseye"></i> Obiettivo</label>
                    <i class="fas fa-flag-checkered input-icon"></i>
                    <select id="obiettivo">
                        <option value="massa">Aumento Massa</option>
                        <option value="definizione">Definizione</option>
                        <option value="forza">Forza</option>
                        <option value="dimagrimento">Dimagrimento</option>
                        <option value="cardio">Cardio</option>
                    </select>
                </div>
            </div>
            
            <div class="highlight-box">
                <p><strong>Nota:</strong> Compila tutti i campi per generare una scheda personalizzata. La scheda sarà strutturata su 6 settimane di allenamento.</p>
            </div>
            
            <div class="button-group">
                <button onclick="generaScheda()"><i class="fas fa-magic"></i> Genera Scheda</button>
                <button class="secondary" onclick="scaricaPDF()"><i class="fas fa-file-pdf"></i> Scarica in PDF</button>
            </div>
        </div>

        <div class="warmup-stretching">
            <h2><i class="fas fa-fire"></i> Riscaldamento Consigliato</h2>
            <ul>
                <li>5-10 minuti di cyclette o camminata veloce</li>
                <li>3 serie da 15 ripetizioni di squat a corpo libero</li>
                <li>2 serie da 20 jumping jack</li>
                <li>Rotazioni articolari (spalle, anche, polsi, caviglie) per 30 secondi ciascuna</li>
            </ul>
        </div>

        <div id="scheda"></div>

        <div class="warmup-stretching">
            <h2><i class="fas fa-spa"></i> Stretching Consigliato (Post-Allenamento)</h2>
            <ul>
                <li>Stretching pettorali: 30 secondi per lato</li>
                <li>Stretching quadricipiti: 30 secondi per gamba</li>
                <li>Stretching bicipiti femorali: 30 secondi per gamba</li>
                <li>Stretching schiena e spalle: 30 secondi</li>
                <li>Respirazione profonda: 1-2 minuti</li>
            </ul>
        </div>

        <div class="social">
            <h3><i class="fas fa-address-book"></i> Contatti</h3>
            <p><strong>Francesco</strong>: <a href="https://www.instagram.com/francesco_oretti"><i class="fab fa-instagram"></i> Instagram</a> | <a href="https://wa.me/393204152543"><i class="fab fa-whatsapp"></i> WhatsApp: 3204152543</a></p>
            <p><strong>Federico</strong>: <a href="https://www.instagram.com/federico_iacomelli"><i class="fab fa-instagram"></i> Instagram</a> | <a href="https://wa.me/393895175911"><i class="fab fa-whatsapp"></i> WhatsApp: 3895175911</a></p>
        </div>

        <!-- Sezione Donazioni -->
        <div class="donation-section">
            <div class="donation-title">
                <i class="fas fa-hand-holding-heart"></i> Supporta il Progetto
            </div>
            <div class="donation-text">
                Questo generatore di schede di allenamento è offerto gratuitamente. Se lo trovi utile e vuoi contribuire 
                al suo sviluppo e mantenimento, considera una donazione. Ogni contributo ci aiuta a migliorare il servizio!
            </div>
            
            <div class="donation-methods">
                <div class="donation-method">
                    <h4><i class="fas fa-university"></i> Bonifico Bancario</h4>
                    <p>Puoi effettuare un bonifico alle seguenti coordinate:</p>
                    <div class="bank-details">
                        <p><strong>Beneficiario:</strong> ASD CentroFitness</p>
                        <p><strong>IBAN:</strong> IT41 H030 6914 2221 0000 0012 292</p>
                        <p><strong>Banca:</strong> Intesa Sanpaolo</p>
                        <p><strong>Causale:</strong> Donazione progetto Generatore Schede</p>
                    </div>
                    <p style="font-size: 0.8em; margin-top: 10px; color: #666;">
                        <i class="fas fa-info-circle"></i> La donazione non è fiscalmente deducibile
                    </p>
                </div>
                
                <div class="donation-method">
                    <h4><i class="fab fa-paypal"></i> PayPal</h4>
                    <p>Per donazioni rapide via PayPal:</p>
                    <a href="https://www.paypal.com/pools/c/9eFyKvdZv3" target="_blank" style="text-decoration: none;">
                        <button style="background-color: #003087; margin-top: 10px; width: 100%;">
                            <i class="fab fa-paypal"></i> Donazione con PayPal
                        </button>
                    </a>
                    <p style="font-size: 0.8em; margin-top: 10px; color: #666;">
                        <i class="fas fa-lock"></i> Transazione sicura tramite PayPal
                    </p>
                </div>
            </div>
            
            <div id="thankYouMessage" class="thank-you-message">
                <i class="fas fa-heart"></i> <strong>Grazie per il tuo supporto!</strong> La tua donazione ci aiuterà a mantenere e migliorare questo servizio.
                <div id="countdown" style="font-size: 0.8em; margin-top: 5px;"></div>
            </div>
        </div>

        <!-- Sezione Footer -->
        <div class="footer-section">
            <div class="footer-columns">
                <div class="footer-column">
                    <h4>Informazioni</h4>
                    <p>Generatore di schede di allenamento personalizzate per il fitness e il bodybuilding. Strumento professionale per atleti e appassionati.</p>
                    <p><strong>Sede:</strong> Via Roma, 287/A, 53014 Monteroni d'Arbia (SI)</p>
                    <p><strong>Tel:</strong> 389 517 5911</p>
                    <p><strong>Email:</strong> AsdCentroFitness@gmail.com</p>
                </div>
                
                <div class="footer-column">
                    <h4>Privacy</h4>
                    <p>Questo sito non raccoglie dati personali senza il tuo consenso. Tutte le informazioni inserite vengono elaborate solo localmente nel tuo browser.</p>
                    <p><a href="https://www.garanteprivacy.it/home/docweb/-/docweb-display/docweb/1311678" target="_blank" rel="noopener noreferrer"><i class="fas fa-shield-alt"></i> Leggi l'informativa completa sulla privacy (Regolamento UE 2016/679)</a></p>
                </div>
                
                <div class="footer-column">
                    <h4>Dati Societari</h4>
                    <p><strong>A.S.D. CentroFitness</strong></p>
                    <p>P.IVA: 01417350525</p>
                    <p>Codice Fiscale: 92057520527</p>
                    <p><a href="#terms"><i class="fas fa-file-contract"></i> Visualizza i termini completi di utilizzo</a></p>
                </div>
            </div>
            
            <div class="copyright">
                <p>&copy; 2023 A.S.D. CentroFitness - Tutti i diritti riservati</p>
                <p>Il contenuto di questo sito è protetto da copyright e non può essere riprodotto senza autorizzazione.</p>
            </div>
        </div>
    </div>

    <script>
        const esercizi = {
            petto: ["Panca piana con bilanciere", "Croci su panca inclinata con manubri", "Panca declinata con bilanciere", "Chest press", "Push up", "Croci ai cavi alti", "Croci ai cavi bassi", "Croci con manubri su panca piana", "Spinte con manubri su panca inclinata", "Spinte con manubri su panca piana"],
            schiena: ["Lat machine", "Rematore con bilanciere", "Pulley basso", "Trazioni alla sbarra", "Pullover", "Low row", "Lat machine presa inversa", "Lat machine Presa neutra", "Triangolo alla lat machine", "Pulley presa larga"],
            gambe: ["Squat", "Leg press", "Affondi", "Stacchi da terra", "Leg extension", "Adductor machine", "Abductor machine", "Stacchi rumeni", "Hiptrust", "Gluteos machine", "Calf seduto", "Calf in piedi", "Hack squat", "Leg curl", "Good morning"],
            spalle: ["Lento avanti", "Alzate laterali", "Alzate frontali", "Shoulder press", "Alzate a 90°", "Face pull", "Spinte Frontali su panca a 90", "Arnold Press", "Alzate oblique al cavo"],
            braccia: ["Curl con bilanciere", "Curl alternato con manubri", "French press", "Push down", "Hammer curl", "Bicipite machine", "Push down con corda", "Spider curl su panca a 30/45"],
            core: ["Crunch", "Plank", "Russian twist", "Sit-up", "Leg raise"]
        };

        const suggerimenti = {
            "Panca piana con bilanciere": "Controlla il movimento nella fase negativa.",
            "Croci su panca inclinata con manubri": "Concentrati sull'allungamento muscolare.",
            "Panca declinata con bilanciere": "Ottimo per la parte bassa del petto.",
            "Chest press": "Evita di bloccare i gomiti in alto.",
            "Push up": "Mantieni il corpo in linea.",
            "Lat machine": "Tira con i gomiti, non con le mani.",
            "Rematore con bilanciere": "Schiena sempre dritta.",
            "Pulley basso": "Evita lo slancio, concentrati sul movimento.",
            "Trazioni alla sbarra": "Mantieni il controllo in discesa.",
            "Pullover": "Respira profondamente durante l'allungamento.",
            "Squat": "Scendi almeno al parallelo.",
            "Leg press": "Non stendere mai completamente le gambe.",
            "Affondi": "Tieni il busto eretto.",
            "Stacchi da terra": "Usa una forma corretta per evitare infortuni.",
            "Leg extension": "Controlla il movimento e non usare troppo peso.",
            "Lento avanti": "Esegui l'esercizio lentamente.",
            "Alzate laterali": "Usa pesi moderati per controllare il movimento.",
            "Alzate frontali": "Non sollevare oltre le spalle.",
            "Shoulder press": "Mantieni la schiena dritta.",
            "Alzate a 90°": "Movimento lento e controllato.",
            "Curl con bilanciere": "Evita di dondolare il corpo.",
            "Curl alternato con manubri": "Concentrati sulla contrazione.",
            "French press": "Stai attento alla posizione dei gomiti.",
            "Push down": "Non alzare troppo i gomiti.",
            "Hammer curl": "Controlla la fase di discesa.",
            "Crunch": "Non forzare il collo.",
            "Plank": "Tieni il corpo allineato.",
            "Russian twist": "Non usare troppo slancio.",
            "Sit-up": "Mantieni i piedi a terra.",
            "Leg raise": "Evita di inarcare la schiena.",
            "Croci ai cavi alti": "Mantieni i gomiti leggermente flessi e stabili.",
            "Croci ai cavi bassi": "Esegui un movimento diagonale dal basso verso l'alto.",
            "Croci con manubri su panca piana": "Mantieni i gomiti leggermente flessi e fermi.",
            "Spinte con manubri su panca inclinata": "Controlla il movimento, evitando di estendere completamente i gomiti.",
            "Spinte con manubri su panca piana": "Assicurati che i polsi siano allineati con i gomiti.",
            "Low row": "Mantieni la schiena dritta e tira con i gomiti.",
            "Lat machine presa inversa": "Utilizza una presa supina per enfatizzare il lavoro sui bicipiti.",
            "Lat machine presa neutra": "Concentrati sul movimento dei gomiti verso il basso.",
            "Triangolo alla lat machine": "Mantieni il busto leggermente inclinato all'indietro.",
            "Pulley presa larga": "Evita di oscillare il corpo.",
            "Adductor machine": "Esegui il movimento lentamente.",
            "Abductor machine": "Mantieni la schiena appoggiata allo schienale.",
            "Stacchi rumeni": "Mantieni le gambe leggermente flesse e la schiena dritta.",
            "Hiptrust": "Spingi attraverso i talloni e contrai i glutei.",
            "Gluteos machine": "Controlla il movimento, evitando slanci.",
            "Calf seduto": "Esegui il movimento lentamente.",
            "Calf in piedi": "Mantieni le ginocchia leggermente flesse.",
            "Hack squat": "Mantieni la schiena appoggiata allo schienale.",
            "Alzate oblique al cavo": "Esegui il movimento lentamente.",
            "Bicipite machine": "Assicurati che i gomiti rimangano fermi.",
            "Push down con corda": "Mantieni i gomiti vicini al corpo.",
            "Spider curl su panca a 30/45": "Mantieni il petto appoggiato alla panca.",
            "Leg curl": "Mantieni il bacino aderente alla panca durante l'esecuzione.",
            "Good morning": "Mantieni la schiena dritta e piegati solo a livello delle anche."
        };

        function generaScheda() {
            // Validazione input
            const nomeUtente = document.getElementById("nome").value.trim();
            if (!nomeUtente) {
                alert("Inserisci il nome e cognome");
                return;
            }

            const obiettivo = document.getElementById('obiettivo').value;
            const eta = parseInt(document.getElementById("eta").value) || 30;
            const tipologia = document.getElementById('tipologia').value;
            const giorni = parseInt(document.getElementById("giorni").value);
            
            // Gruppi muscolari selezionati in base alla tipologia
            const gruppiSelezionati = getGruppiByTipologia(tipologia);
            if (gruppiSelezionati.length === 0) return; // Per cardio
            
            // Distribuzione dei gruppi muscolari per giorno
            const gruppiPerSettimana = distribuisciGruppi(gruppiSelezionati, giorni, tipologia);

            let output = `<h2 class="success"><i class="fas fa-check-circle"></i> Scheda di allenamento per ${nomeUtente}</h2>`;
            
            for (let settimana = 1; settimana <= 6; settimana++) {
                output += generaSettimana(settimana, eta, tipologia, giorni, gruppiPerSettimana, obiettivo);
            }

            document.getElementById("scheda").innerHTML = output;
        }

        function getGruppiByTipologia(tipologia) {
            const gruppi = Object.keys(esercizi);
            switch(tipologia) {
                case "classica": return [...gruppi];
                case "totalbody": return [...gruppi];
                case "over60": return ["gambe", "spalle", "core"];
                case "gambe": return ["gambe"];
                case "cardio": 
                    document.getElementById("scheda").innerHTML = `
                        <h2><i class="fas fa-heartbeat"></i> Programma Cardio</h2>
                        <div class="highlight-box">
                            <p><strong>Obiettivo:</strong> Migliorare la resistenza cardiovascolare</p>
                        </div>
                        <ul>
                            <li><i class="fas fa-running"></i> 20 min camminata veloce</li>
                            <li><i class="fas fa-jump-rope"></i> 10 min salti con la corda</li>
                            <li><i class="fas fa-bicycle"></i> 20 min cyclette</li>
                            <li><i class="fas fa-spa"></i> Stretching finale</li>
                        </ul>
                        <p class="warning"><i class="fas fa-info-circle"></i> Ripetere 3-4 volte a settimana</p>
                    `;
                    return [];
                default: return [...gruppi];
            }
        }

        function distribuisciGruppi(gruppiSelezionati, giorni, tipologia) {
            const gruppiPerSettimana = [];
            if (tipologia === "totalbody") {
                // Mescola i gruppi per varietà
                const shuffled = [...gruppiSelezionati].sort(() => 0.5 - Math.random());
                for (let i = 0; i < giorni; i++) {
                    const start = (i * 3) % gruppiSelezionati.length;
                    let gruppoGiorno = shuffled.slice(start, start + 3);
                    if (gruppoGiorno.length < 3) {
                        grupoGiorno = grupoGiorno.concat(shuffled.slice(0, 3 - grupoGiorno.length));
                    }
                    gruppiPerSettimana.push(gruppoGiorno);
                }
            } else {
                // Distribuzione ciclica dei gruppi
                for (let i = 0; i < giorni; i++) {
                    gruppiPerSettimana.push([gruppiSelezionati[i % gruppiSelezionati.length]]);
                }
            }
            return gruppiPerSettimana;
        }

        function generaSettimana(settimana, eta, tipologia, giorni, gruppiPerSettimana, obiettivo) {
            let output = `<div class="week-title"><i class="fas fa-calendar-week"></i> Settimana ${settimana}</div>`;
            if (eta >= 50 || tipologia === "over60") {
                output += `<p class="warning"><i class="fas fa-info-circle"></i> Scheda adattata per età superiore ai 50 anni</p>`;
            }

            for (let i = 0; i < giorni; i++) {
                output += generaGiornoAllenamento(i+1, gruppiPerSettimana[i], tipologia, obiettivo, eta);
            }
            return output;
        }

        function generaGiornoAllenamento(giorno, gruppiGiorno, tipologia, obiettivo, eta) {
            const nomeGruppo = gruppiGiorno.map(g => g.charAt(0).toUpperCase() + g.slice(1)).join(" / ");
            const numEsercizi = tipologia === "totalbody" ? 6 : 5 + Math.floor(Math.random() * 3);
            
            let eserciziGiorno = [];
            
            if (gruppiGiorno.includes("gambe")) {
                // Filtra solo gli esercizi esistenti nella lista
                const eserciziGambeDisponibili = [...esercizi.gambe];
                const eserciziQuadDisponibili = ["Squat", "Leg press", "Leg extension", "Hack squat"]
                    .filter(ex => esercizi.gambe.includes(ex));
                const eserciziFemoraliDisponibili = ["Stacchi da terra", "Stacchi rumeni", "Leg curl", "Good morning"]
                    .filter(ex => esercizi.gambe.includes(ex));

                // Seleziona 2 quadricipiti (se disponibili)
                const quadExercises = [];
                const tempQuad = [...eserciziQuadDisponibili];
                for (let i = 0; i < Math.min(2, tempQuad.length); i++) {
                    const randomIndex = Math.floor(Math.random() * tempQuad.length);
                    quadExercises.push(tempQuad[randomIndex]);
                    tempQuad.splice(randomIndex, 1);
                }

                // Seleziona 2 femorali (se disponibili)
                const femoraliExercises = [];
                const tempFemorali = [...eserciziFemoraliDisponibili];
                for (let i = 0; i < Math.min(2, tempFemorali.length); i++) {
                    const randomIndex = Math.floor(Math.random() * tempFemorali.length);
                    femoraliExercises.push(tempFemorali[randomIndex]);
                    tempFemorali.splice(randomIndex, 1);
                }

                // Combina e completa con altri esercizi
                const eserciziObbligatori = [...quadExercises, ...femoraliExercises];
                const altriEsercizi = eserciziGambeDisponibili
                    .filter(ex => !eserciziObbligatori.includes(ex))
                    .sort(() => 0.5 - Math.random())
                    .slice(0, numEsercizi - eserciziObbligatori.length);

                eserciziGiorno = [...eserciziObbligatori, ...altriEsercizi];
                
                // Se non raggiungiamo il minimo, aggiungiamo altri esercizi disponibili
                if (eserciziGiorno.length < 5) {
                    const extra = eserciziGambeDisponibili
                        .filter(ex => !eserciziGiorno.includes(ex))
                        .slice(0, 5 - eserciziGiorno.length);
                    eserciziGiorno = [...eserciziGiorno, ...extra];
                }
            } else {
                // Per altri gruppi muscolari
                eserciziGiorno = gruppiGiorno
                    .flatMap(gr => [...esercizi[gr]])
                    .sort(() => 0.5 - Math.random())
                    .slice(0, numEsercizi);
            }

            let output = `<div class="day-title"><i class="fas fa-dumbbell"></i> Giorno ${giorno} - ${nomeGruppo}</div>
                <div class="highlight-box">
                    <p><strong>Obiettivo:</strong> ${getObiettivoText(obiettivo)}</p>
                    <p><strong>Durata stimata:</strong> ${getDurataStimata(eserciziGiorno.length)} minuti</p>
                    ${gruppiGiorno.includes("gambe") ? '<p><i class="fas fa-info-circle"></i> <strong>Focus:</strong> Bilanciamento tra quadricipiti e femorali</p>' : ''}
                </div>
                <table>
                    <tr>
                        <th>Esercizio</th>
                        <th>Serie</th>
                        <th>Ripetizioni</th>
                        <th>Intensità</th>
                        <th>Recupero</th>
                        <th>Suggerimento</th>
                    </tr>`;

            for (let es of eserciziGiorno) {
                const { serie, rip, intensita, recupero } = getParametriEsercizio(obiettivo, eta, tipologia);
                const tip = suggerimenti[es] || "";
                output += `<tr>
                    <td><i class="fas fa-dumbbell exercise-icon"></i>${es}</td>
                    <td>${serie}</td>
                    <td>${rip}</td>
                    <td>${intensita}</td>
                    <td>${recupero}</td>
                    <td style='color:#666;font-size:0.9em;'>${tip}</td>
                </tr>`;
            }
            output += "</table>";
            return output;
        }

        function getObiettivoText(obiettivo) {
            const obiettivi = {
                "massa": "Aumento massa muscolare",
                "definizione": "Definizione muscolare",
                "forza": "Aumento forza",
                "dimagrimento": "Dimagrimento",
                "cardio": "Miglioramento capacità cardiovascolare"
            };
            return obiettivi[obiettivo] || "Allenamento generico";
        }

        function getDurataStimata(numEsercizi) {
            return numEsercizi * 10 + 10; // 10 min per esercizio + 10 min riscaldamento/stretching
        }

        function getParametriEsercizio(obiettivo, eta, tipologia) {
            let rip, serie, intensita, recupero;
            
            if (obiettivo === "massa") {
                rip = "8-10";
                serie = "3-4";
            } else if (obiettivo === "definizione") {
                rip = "12-15";
                serie = "3";
            } else { // forza o default
                rip = "5-7";
                serie = "4-5";
            }

            if (eta >= 50 || tipologia === "over60") {
                intensita = obiettivo === "massa" ? "60-70%" : obiettivo === "definizione" ? "50-60%" : "70-80%";
                recupero = obiettivo === "massa" ? "90-120 sec" : obiettivo === "definizione" ? "60-90 sec" : "120-150 sec";
            } else {
                intensita = obiettivo === "massa" ? "75-85%" : obiettivo === "definizione" ? "60-70%" : "85-95%";
                recupero = obiettivo === "massa" ? "60-90 sec" : obiettivo === "definizione" ? "30-60 sec" : "90-120 sec";
            }

            return { serie, rip, intensita, recupero };
        }

        function scaricaPDF() {
            const element = document.getElementById("scheda");
            if (element.innerHTML.trim() === "") {
                alert("Genera prima una scheda di allenamento");
                return;
            }
            const opt = {
                margin: 10,
                filename: 'scheda_allenamento.pdf',
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2 },
                jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
            };
            html2pdf().set(opt).from(element).save();
        }

        // Gestione completa delle donazioni
        function handlePayPalDonation() {
            // Imposta un flag per 30 minuti (in caso di ritorno allo stesso browser)
            const expirationDate = new Date();
            expirationDate.setMinutes(expirationDate.getMinutes() + 30);
            document.cookie = `pendingDonation=true; expires=${expirationDate.toUTCString()}; path=/`;
            
            // Apri PayPal in una nuova finestra con URL di ritorno
            const returnUrl = `${window.location.origin}${window.location.pathname}?donation_success=1`;
            const paypalUrl = `https://www.paypal.com/pools/c/9eFyKvdZv3?return_url=${encodeURIComponent(returnUrl)}`;
            window.open(paypalUrl, '_blank');
        }

        // Mostra il messaggio di ringraziamento
        function showThankYou() {
            const thankYou = document.getElementById('thankYouMessage');
            const countdownEl = document.getElementById('countdown');
            
            thankYou.style.display = 'block';
            thankYou.scrollIntoView({ behavior: 'smooth' });
            
            // Countdown per la chiusura automatica
            let secondsLeft = 10;
            countdownEl.textContent = `Il messaggio si chiuderà automaticamente in ${secondsLeft} secondi...`;
            
            const countdownInterval = setInterval(() => {
                secondsLeft--;
                countdownEl.textContent = `Il messaggio si chiuderà automaticamente in ${secondsLeft} secondi...`;
                
                if (secondsLeft <= 0) {
                    clearInterval(countdownInterval);
                    thankYou.style.display = 'none';
                }
            }, 1000);
        }

        // Verifica al caricamento della pagina
        document.addEventListener('DOMContentLoaded', function() {
            // Controlla il parametro URL
            const urlParams = new URLSearchParams(window.location.search);
            const donationSuccess = urlParams.get('donation_success');
            
            // Controlla i cookie
            const hasPendingDonation = document.cookie.split(';').some(item => item.trim().startsWith('pendingDonation='));
            
            if (donationSuccess === '1' || hasPendingDonation) {
                // Mostra il ringraziamento
                showThankYou();
                
                // Pulizia
                if (donationSuccess) {
                    // Rimuovi il parametro dall'URL
                    history.replaceState(null, '', window.location.pathname);
                }
                
                // Elimina il cookie
                document.cookie = 'pendingDonation=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';
            }
        });
    </script>
</body>
</html>