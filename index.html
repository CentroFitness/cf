<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generatore di Schede di Allenamento</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=Oswald:wght@500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #ff4757;
            --primary-light: #ff6b81;
            --primary-dark: #ff0000;
            --secondary: #2f3542;
            --secondary-light: #57606f;
            --accent: #ff6b81;
            --light: #f1f2f6;
            --dark: #1e272e;
            --success: #2ed573;
            --success-light: #7bed9f;
            --warning: #ffa502;
            --warning-light: #ffbe76;
            --info: #1e90ff;
            --info-light: #70a1ff;
        }
        
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Montserrat', sans-serif;
            background-color: #f8f9fa;
            background-image: linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(255,255,255,0.9) 100%), url('https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?q=80&w=2070&auto=format&fit=crop');
            background-size: cover;
            background-attachment: fixed;
            color: var(--dark);
            line-height: 1.6;
            padding: 0;
            margin: 0;
            -webkit-text-size-adjust: 100%;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 15px;
            width: 100%;
        }
        
        header {
            background: linear-gradient(135deg, var(--secondary), var(--dark));
            color: white;
            padding: 20px 0;
            text-align: center;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }
        
        h1, h2, h3, h4 {
            font-family: 'Oswald', sans-serif;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            margin-top: 0;
        }
        
        h1 {
            font-size: clamp(1.8rem, 5vw, 2.8rem);
            margin: 0;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            position: relative;
            padding: 0 10px;
        }
        
        h2 {
            color: var(--secondary);
            font-size: clamp(1.4rem, 4vw, 1.8rem);
            margin-top: 25px;
            border-bottom: 3px solid var(--primary);
            padding-bottom: 8px;
            display: inline-block;
        }
        
        .logo {
            font-size: clamp(1.8rem, 6vw, 3rem);
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
            padding: 0 10px;
        }
        
        .form-container {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(0,0,0,0.1);
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(min(300px, 100%), 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .form-group {
            margin-bottom: 12px;
            position: relative;
        }
        
        label {
            display: block;
            margin-bottom: 6px;
            font-weight: 600;
            color: var(--secondary);
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: clamp(0.9rem, 3vw, 1rem);
        }
        
        input, select {
            width: 100%;
            padding: 12px 15px 12px 35px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: clamp(0.9rem, 3vw, 1rem);
            transition: all 0.3s;
            background-color: #fff;
            -webkit-appearance: none;
        }
        
        .input-icon {
            position: absolute;
            left: 12px;
            top: 38px;
            color: var(--secondary-light);
            font-size: clamp(0.9rem, 3vw, 1rem);
        }
        
        button {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 12px 20px;
            font-size: clamp(0.9rem, 3vw, 1rem);
            font-weight: 600;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin: 8px 8px 0 0;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            width: 100%;
            justify-content: center;
        }
        
        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }
        
        .button-group button {
            width: auto;
            flex: 1 1 auto;
            min-width: 150px;
        }
        
        #scheda {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-top: 25px;
            position: relative;
            border: 1px solid rgba(0,0,0,0.1);
            overflow-x: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            min-width: 600px;
        }
        
        th, td {
            padding: 10px 12px;
            text-align: left;
            font-size: clamp(0.8rem, 3vw, 0.9rem);
        }
        
        th {
            background-color: var(--secondary);
            color: white;
            position: sticky;
            top: 0;
        }
        
        td {
            border-bottom: 1px solid #eee;
        }
        
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        .warmup-stretching {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin: 20px 0;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(0,0,0,0.1);
        }
        
        ul {
            padding-left: 20px;
            list-style-type: none;
            margin: 15px 0;
        }
        
        li {
            margin-bottom: 8px;
            position: relative;
            padding-left: 25px;
            font-size: clamp(0.9rem, 3vw, 1rem);
        }
        
        .social {
            background: var(--secondary);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-top: 30px;
            position: relative;
            overflow: hidden;
        }
        
        .social a {
            color: var(--accent);
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            font-size: clamp(0.9rem, 3vw, 1rem);
        }
        
        .success {
            color: var(--success);
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: clamp(1rem, 4vw, 1.2rem);
        }
        
        .warning {
            color: var(--warning);
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: clamp(0.9rem, 3vw, 1rem);
        }
        
        .highlight-box {
            background: linear-gradient(135deg, #fff5f5, #ffecec);
            border-left: 4px solid var(--primary);
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 6px 6px 0;
            position: relative;
            font-size: clamp(0.9rem, 3vw, 1rem);
        }
        
        .week-title {
            background: linear-gradient(135deg, var(--secondary), var(--dark));
            color: white;
            padding: 8px 12px;
            border-radius: 5px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin: 15px 0 8px;
            font-size: clamp(1rem, 4vw, 1.2rem);
        }
        
        .day-title {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            padding: 6px 12px;
            border-radius: 5px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin: 12px 0 6px;
            font-size: clamp(0.9rem, 3vw, 1.1rem);
        }
        
        .exercise-icon {
            color: var(--primary);
            margin-right: 6px;
            font-size: 0.9em;
        }
        
        /* Mobile specific styles */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            header {
                padding: 15px 0;
                margin-bottom: 15px;
            }
            
            .form-container, #scheda, .warmup-stretching, .social {
                padding: 15px;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .button-group {
                flex-direction: column;
                gap: 8px;
            }
            
            .button-group button {
                width: 100%;
                min-width: unset;
            }
            
            table {
                font-size: 0.8rem;
            }
            
            th, td {
                padding: 8px 10px;
            }
        }
        
        @media (max-width: 480px) {
            h1 {
                font-size: 1.6rem;
            }
            
            h2 {
                font-size: 1.3rem;
            }
            
            .logo {
                font-size: 1.6rem;
                gap: 5px;
            }
            
            input, select {
                padding: 10px 12px 10px 30px;
            }
            
            .input-icon {
                left: 10px;
                top: 33px;
            }
            
            button {
                padding: 10px 15px;
            }
        }
        
        /* Print styles */
        @media print {
            body {
                background: white;
                font-size: 12pt;
            }
            
            .container {
                padding: 0;
                max-width: 100%;
            }
            
            header, .form-container, .button-group, .social {
                display: none;
            }
            
            #scheda, .warmup-stretching {
                box-shadow: none;
                border: none;
                padding: 0;
                margin: 0 0 20px 0;
                page-break-inside: avoid;
            }
            
            table {
                page-break-inside: auto;
            }
            
            tr {
                page-break-inside: avoid;
                page-break-after: auto;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="logo">A.S.D CENTROFITNESS</div>
            <h1>Generatore di Schede di Allenamento</h1>
            <p>Personalizza la tua scheda di allenamento per le prossime 6 settimane</p>
        </div>
    </header>

    <div class="container">
        <div class="form-container">
            <h2><i class="fas fa-user"></i> Informazioni Personali</h2>
            <div class="form-grid">
                <div class="form-group">
                    <label for="nome"><i class="fas fa-signature"></i> Nome e Cognome</label>
                    <i class="fas fa-user input-icon"></i>
                    <input type="text" id="nome" placeholder="Es. Mario Rossi" required>
                </div>
                
                <div class="form-group">
                    <label for="eta"><i class="fas fa-birthday-cake"></i> Età</label>
                    <i class="fas fa-calendar-alt input-icon"></i>
                    <input type="number" id="eta" min="10" max="100" value="30">
                </div>
                
                <div class="form-group">
                    <label for="genere"><i class="fas fa-venus-mars"></i> Genere</label>
                    <i class="fas fa-user-tag input-icon"></i>
                    <select id="genere">
                        <option value="uomo">Uomo</option>
                        <option value="donna">Donna</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="peso"><i class="fas fa-weight"></i> Peso (kg)</label>
                    <i class="fas fa-weight-hanging input-icon"></i>
                    <input type="number" id="peso" min="30" max="200">
                </div>
                
                <div class="form-group">
                    <label for="altezza"><i class="fas fa-ruler-vertical"></i> Altezza (cm)</label>
                    <i class="fas fa-arrows-alt-v input-icon"></i>
                    <input type="number" id="altezza" min="120" max="250">
                </div>
                
                <div class="form-group">
                    <label for="fisico"><i class="fas fa-tshirt"></i> Tipo di fisico</label>
                    <i class="fas fa-user-shield input-icon"></i>
                    <select id="fisico">
                        <option value="ectomorfo">Ectomorfo</option>
                        <option value="mesomorfo">Mesomorfo</option>
                        <option value="endomorfo">Endomorfo</option>
                    </select>
                </div>
            </div>
            
            <h2><i class="fas fa-dumbbell"></i> Preferenze Allenamento</h2>
            <div class="form-grid">
                <div class="form-group">
                    <label for="tipologia"><i class="fas fa-clipboard-list"></i> Tipologia di scheda</label>
                    <i class="fas fa-tasks input-icon"></i>
                    <select id="tipologia">
                        <option value="classica">Classica</option>
                        <option value="totalbody">Total Body</option>
                        <option value="over60">Over 60</option>
                        <option value="gambe">Solo Gambe</option>
                        <option value="cardio">Solo Cardio</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="giorni"><i class="fas fa-calendar-day"></i> Giorni di allenamento</label>
                    <i class="fas fa-calendar-week input-icon"></i>
                    <select id="giorni">
                        <option value="3">3 giorni</option>
                        <option value="4">4 giorni</option>
                        <option value="5">5 giorni</option>
                        <option value="6" selected>6 giorni</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="obiettivo"><i class="fas fa-bullseye"></i> Obiettivo</label>
                    <i class="fas fa-flag-checkered input-icon"></i>
                    <select id="obiettivo">
                        <option value="massa">Aumento Massa</option>
                        <option value="definizione">Definizione</option>
                        <option value="forza">Forza</option>
                        <option value="dimagrimento">Dimagrimento</option>
                        <option value="cardio">Cardio</option>
                    </select>
                </div>
            </div>
            
            <div class="highlight-box">
                <p><strong>Nota:</strong> Compila tutti i campi per generare una scheda personalizzata. La scheda sarà strutturata su 6 settimane di allenamento.</p>
            </div>
            
            <div class="button-group">
                <button onclick="generaScheda()"><i class="fas fa-magic"></i> Genera Scheda</button>
                <button class="secondary" onclick="scaricaPDF()"><i class="fas fa-file-pdf"></i> Scarica in PDF</button>
            </div>
        </div>

        <div class="warmup-stretching">
            <h2><i class="fas fa-fire"></i> Riscaldamento Consigliato</h2>
            <ul>
                <li>5-10 minuti di cyclette o camminata veloce</li>
                <li>3 serie da 15 ripetizioni di squat a corpo libero</li>
                <li>2 serie da 20 jumping jack</li>
                <li>Rotazioni articolari (spalle, anche, polsi, caviglie) per 30 secondi ciascuna</li>
            </ul>
        </div>

        <div id="scheda"></div>

        <div class="warmup-stretching">
            <h2><i class="fas fa-spa"></i> Stretching Consigliato (Post-Allenamento)</h2>
            <ul>
                <li>Stretching pettorali: 30 secondi per lato</li>
                <li>Stretching quadricipiti: 30 secondi per gamba</li>
                <li>Stretching bicipiti femorali: 30 secondi per gamba</li>
                <li>Stretching schiena e spalle: 30 secondi</li>
                <li>Respirazione profonda: 1-2 minuti</li>
            </ul>
        </div>

        <div class="social">
            <h3><i class="fas fa-address-book"></i> Contatti</h3>
            <p><strong>Francesco</strong>: <a href="https://www.instagram.com/francesco_oretti"><i class="fab fa-instagram"></i> Instagram</a> | <a href="https://wa.me/393204152543"><i class="fab fa-whatsapp"></i> WhatsApp: 3204152543</a></p>
            <p><strong>Federico</strong>: <a href="https://www.instagram.com/federico_iacomelli"><i class="fab fa-instagram"></i> Instagram</a> | <a href="https://wa.me/393895175911"><i class="fab fa-whatsapp"></i> WhatsApp: 3895175911</a></p>
        </div>
    </div>

    <script>
        const esercizi = {
            petto: ["Panca piana con bilanciere", "Croci su panca inclinata con manubri", "Panca declinata con bilanciere", "Chest press", "Push up", "Croci ai cavi alti", "Croci ai cavi bassi", "Croci con manubri su panca piana", "Spinte con manubri su panca inclinata", "Spinte con manubri su panca piana"],
            schiena: ["Lat machine", "Rematore con bilanciere", "Pulley basso", "Trazioni alla sbarra", "Pullover", "Low row", "Lat machine presa inversa", "Lat machine Presa neutra", "Triangolo alla lat machine", "Pulley presa larga"],
            gambe: ["Squat", "Leg press", "Affondi", "Stacchi da terra", "Leg extension", "Adductor machine", "Abductor machine", "Stacchi rumeni", "Hiptrust", "Gluteos machine", "Calf seduto", "Calf in piedi", "Hack squat"],
            spalle: ["Lento avanti", "Alzate laterali", "Alzate frontali", "Shoulder press", "Alzate a 90°", "Face pull", "Spinte Frontali su panca a 90", "Arnold Press", "Alzate oblique al cavo"],
            braccia: ["Curl con bilanciere", "Curl alternato con manubri", "French press", "Push down", "Hammer curl", "Bicipite machine", "Push down con corda", "Spider curl su panca a 30/45"],
            core: ["Crunch", "Plank", "Russian twist", "Sit-up", "Leg raise"]
        };

        const suggerimenti = {
            "Panca piana con bilanciere": "Controlla il movimento nella fase negativa.",
            "Croci su panca inclinata con manubri": "Concentrati sull'allungamento muscolare.",
            "Panca declinata con bilanciere": "Ottimo per la parte bassa del petto.",
            "Chest press": "Evita di bloccare i gomiti in alto.",
            "Push up": "Mantieni il corpo in linea.",
            "Lat machine": "Tira con i gomiti, non con le mani.",
            "Rematore con bilanciere": "Schiena sempre dritta.",
            "Pulley basso": "Evita lo slancio, concentrati sul movimento.",
            "Trazioni alla sbarra": "Mantieni il controllo in discesa.",
            "Pullover": "Respira profondamente durante l'allungamento.",
            "Squat": "Scendi almeno al parallelo.",
            "Leg press": "Non stendere mai completamente le gambe.",
            "Affondi": "Tieni il busto eretto.",
            "Stacchi da terra": "Usa una forma corretta per evitare infortuni.",
            "Leg extension": "Controlla il movimento e non usare troppo peso.",
            "Lento avanti": "Esegui l'esercizio lentamente.",
            "Alzate laterali": "Usa pesi moderati per controllare il movimento.",
            "Alzate frontali": "Non sollevare oltre le spalle.",
            "Shoulder press": "Mantieni la schiena dritta.",
            "Alzate a 90°": "Movimento lento e controllato.",
            "Curl con bilanciere": "Evita di dondolare il corpo.",
            "Curl alternato con manubri": "Concentrati sulla contrazione.",
            "French press": "Stai attento alla posizione dei gomiti.",
            "Push down": "Non alzare troppo i gomiti.",
            "Hammer curl": "Controlla la fase di discesa.",
            "Crunch": "Non forzare il collo.",
            "Plank": "Tieni il corpo allineato.",
            "Russian twist": "Non usare troppo slancio.",
            "Sit-up": "Mantieni i piedi a terra.",
            "Leg raise": "Evita di inarcare la schiena.",
            "Croci ai cavi alti": "Mantieni i gomiti leggermente flessi e stabili.",
            "Croci ai cavi bassi": "Esegui un movimento diagonale dal basso verso l'alto.",
            "Croci con manubri su panca piana": "Mantieni i gomiti leggermente flessi e fermi.",
            "Spinte con manubri su panca inclinata": "Controlla il movimento, evitando di estendere completamente i gomiti.",
            "Spinte con manubri su panca piana": "Assicurati che i polsi siano allineati con i gomiti.",
            "Low row": "Mantieni la schiena dritta e tira con i gomiti.",
            "Lat machine presa inversa": "Utilizza una presa supina per enfatizzare il lavoro sui bicipiti.",
            "Lat machine presa neutra": "Concentrati sul movimento dei gomiti verso il basso.",
            "Triangolo alla lat machine": "Mantieni il busto leggermente inclinato all'indietro.",
            "Pulley presa larga": "Evita di oscillare il corpo.",
            "Adductor machine": "Esegui il movimento lentamente.",
            "Abductor machine": "Mantieni la schiena appoggiata allo schienale.",
            "Stacchi rumeni": "Mantieni le gambe leggermente flesse e la schiena dritta.",
            "Hiptrust": "Spingi attraverso i talloni e contrai i glutei.",
            "Gluteos machine": "Controlla il movimento, evitando slanci.",
            "Calf seduto": "Esegui il movimento lentamente.",
            "Calf in piedi": "Mantieni le ginocchia leggermente flesse.",
            "Hack squat": "Mantieni la schiena appoggiata allo schienale.",
            "Alzate oblique al cavo": "Esegui il movimento lentamente.",
            "Bicipite machine": "Assicurati che i gomiti rimangano fermi.",
            "Push down con corda": "Mantieni i gomiti vicini al corpo.",
            "Spider curl su panca a 30/45": "Mantieni il petto appoggiato alla panca."
        };

        function generaScheda() {
            // Validazione input
            const nomeUtente = document.getElementById("nome").value.trim();
            if (!nomeUtente) {
                alert("Inserisci il nome e cognome");
                return;
            }

            const obiettivo = document.getElementById('obiettivo').value;
            const eta = parseInt(document.getElementById("eta").value) || 30;
            const tipologia = document.getElementById('tipologia').value;
            const giorni = parseInt(document.getElementById("giorni").value);
            
            // Gruppi muscolari selezionati in base alla tipologia
            const gruppiSelezionati = getGruppiByTipologia(tipologia);
            if (gruppiSelezionati.length === 0) return; // Per cardio
            
            // Distribuzione dei gruppi muscolari per giorno
            const gruppiPerSettimana = distribuisciGruppi(gruppiSelezionati, giorni, tipologia);

            let output = `<h2 class="success"><i class="fas fa-check-circle"></i> Scheda di allenamento per ${nomeUtente}</h2>`;
            
            for (let settimana = 1; settimana <= 6; settimana++) {
                output += generaSettimana(settimana, eta, tipologia, giorni, gruppiPerSettimana, obiettivo);
            }

            document.getElementById("scheda").innerHTML = output;
        }

        // Funzioni helper
        function getGruppiByTipologia(tipologia) {
            const gruppi = Object.keys(esercizi);
            switch(tipologia) {
                case "classica": return [...gruppi];
                case "totalbody": return [...gruppi];
                case "over60": return ["gambe", "spalle", "core"];
                case "gambe": return ["gambe"];
                case "cardio": 
                    document.getElementById("scheda").innerHTML = `
                        <h2><i class="fas fa-heartbeat"></i> Programma Cardio</h2>
                        <div class="highlight-box">
                            <p><strong>Obiettivo:</strong> Migliorare la resistenza cardiovascolare</p>
                        </div>
                        <ul>
                            <li><i class="fas fa-running"></i> 20 min camminata veloce</li>
                            <li><i class="fas fa-jump-rope"></i> 10 min salti con la corda</li>
                            <li><i class="fas fa-bicycle"></i> 20 min cyclette</li>
                            <li><i class="fas fa-spa"></i> Stretching finale</li>
                        </ul>
                        <p class="warning"><i class="fas fa-info-circle"></i> Ripetere 3-4 volte a settimana</p>
                    `;
                    return [];
                default: return [...gruppi];
            }
        }

        function distribuisciGruppi(gruppiSelezionati, giorni, tipologia) {
            const gruppiPerSettimana = [];
            if (tipologia === "totalbody") {
                // Mescola i gruppi per varietà
                const shuffled = [...gruppiSelezionati].sort(() => 0.5 - Math.random());
                for (let i = 0; i < giorni; i++) {
                    const start = (i * 3) % gruppiSelezionati.length;
                    let gruppoGiorno = shuffled.slice(start, start + 3);
                    if (gruppoGiorno.length < 3) {
                        gruppoGiorno = gruppoGiorno.concat(shuffled.slice(0, 3 - gruppoGiorno.length));
                    }
                    gruppiPerSettimana.push(gruppoGiorno);
                }
            } else {
                // Distribuzione ciclica dei gruppi
                for (let i = 0; i < giorni; i++) {
                    gruppiPerSettimana.push([gruppiSelezionati[i % gruppiSelezionati.length]]);
                }
            }
            return gruppiPerSettimana;
        }

        function generaSettimana(settimana, eta, tipologia, giorni, gruppiPerSettimana, obiettivo) {
            let output = `<div class="week-title"><i class="fas fa-calendar-week"></i> Settimana ${settimana}</div>`;
            if (eta >= 50 || tipologia === "over60") {
                output += `<p class="warning"><i class="fas fa-info-circle"></i> Scheda adattata per età superiore ai 50 anni</p>`;
            }

            for (let i = 0; i < giorni; i++) {
                output += generaGiornoAllenamento(i+1, gruppiPerSettimana[i], tipologia, obiettivo, eta);
            }
            return output;
        }

        function generaGiornoAllenamento(giorno, gruppiGiorno, tipologia, obiettivo, eta) {
            const nomeGruppo = gruppiGiorno.map(g => g.charAt(0).toUpperCase() + g.slice(1)).join(" / ");
            const numEsercizi = tipologia === "totalbody" ? 6 : 4 + Math.floor(Math.random() * 3);
            
            const eserciziGiorno = gruppiGiorno
                .flatMap(gr => esercizi[gr])
                .sort(() => 0.5 - Math.random())
                .slice(0, numEsercizi);

            let output = `<div class="day-title"><i class="fas fa-dumbbell"></i> Giorno ${giorno} - ${nomeGruppo}</div>
                <div class="highlight-box">
                    <p><strong>Obiettivo:</strong> ${getObiettivoText(obiettivo)}</p>
                    <p><strong>Durata stimata:</strong> ${getDurataStimata(numEsercizi)} minuti</p>
                </div>
                <table>
                    <tr>
                        <th>Esercizio</th>
                        <th>Serie</th>
                        <th>Ripetizioni</th>
                        <th>Intensità</th>
                        <th>Recupero</th>
                        <th>Suggerimento</th>
                    </tr>`;

            for (let es of eserciziGiorno) {
                const { serie, rip, intensita, recupero } = getParametriEsercizio(obiettivo, eta, tipologia);
                const tip = suggerimenti[es] || "";
                output += `<tr>
                    <td><i class="fas fa-dumbbell exercise-icon"></i>${es}</td>
                    <td>${serie}</td>
                    <td>${rip}</td>
                    <td>${intensita}</td>
                    <td>${recupero}</td>
                    <td style='color:#666;font-size:0.9em;'>${tip}</td>
                </tr>`;
            }
            output += "</table>";
            return output;
        }

        function getObiettivoText(obiettivo) {
            const obiettivi = {
                "massa": "Aumento massa muscolare",
                "definizione": "Definizione muscolare",
                "forza": "Aumento forza",
                "dimagrimento": "Dimagrimento",
                "cardio": "Miglioramento capacità cardiovascolare"
            };
            return obiettivi[obiettivo] || "Allenamento generico";
        }

        function getDurataStimata(numEsercizi) {
            return numEsercizi * 10 + 10; // 10 min per esercizio + 10 min riscaldamento/stretching
        }

        function getParametriEsercizio(obiettivo, eta, tipologia) {
            let rip, serie, intensita, recupero;
            
            if (obiettivo === "massa") {
                rip = "8-10";
                serie = "3-4";
            } else if (obiettivo === "definizione") {
                rip = "12-15";
                serie = "3";
            } else { // forza o default
                rip = "5-7";
                serie = "4-5";
            }

            if (eta >= 50 || tipologia === "over60") {
                intensita = obiettivo === "massa" ? "60-70%" : obiettivo === "definizione" ? "50-60%" : "70-80%";
                recupero = obiettivo === "massa" ? "90-120 sec" : obiettivo === "definizione" ? "60-90 sec" : "120-150 sec";
            } else {
                intensita = obiettivo === "massa" ? "75-85%" : obiettivo === "definizione" ? "60-70%" : "85-95%";
                recupero = obiettivo === "massa" ? "60-90 sec" : obiettivo === "definizione" ? "30-60 sec" : "90-120 sec";
            }

            return { serie, rip, intensita, recupero };
        }

        function scaricaPDF() {
            const schedaContent = document.getElementById("scheda").innerHTML.trim();
            if (!schedaContent) {
                alert("Genera prima una scheda di allenamento");
                return;
            }

            // Creiamo un elemento temporaneo che include tutto il contenuto da esportare
            const element = document.createElement("div");
            element.id = "pdf-export";
            
            // Cloniamo gli elementi importanti
            const header = document.querySelector("header").cloneNode(true);
            const scheda = document.getElementById("scheda").cloneNode(true);
            const warmup = document.querySelectorAll(".warmup-stretching")[0].cloneNode(true);
            const stretching = document.querySelectorAll(".warmup-stretching")[1].cloneNode(true);
            
            // Aggiungiamo stili specifici per il PDF
            element.innerHTML = `
                <style>
                    body { font-family: Arial, sans-serif; font-size: 12pt; }
                    h1, h2, h3, h4 { color: #000; }
                    table { width: 100%; border-collapse: collapse; margin: 10px 0; font-size: 10pt; }
                    th { background-color: #2f3542; color: white; padding: 8px; text-align: left; }
                    td { padding: 6px; border: 1px solid #ddd; }
                    .logo { font-size: 18pt; font-weight: bold; color: #ff4757; }
                    ul { padding-left: 20px; }
                    li { margin-bottom: 5px; }
                    .highlight-box { background: #f5f5f5; padding: 10px; margin: 10px 0; }
                    .week-title, .day-title { color: white; padding: 5px 10px; margin: 5px 0; }
                </style>
            `;
            
            // Aggiungiamo gli elementi clonati
            element.appendChild(header);
            element.appendChild(warmup);
            element.appendChild(scheda);
            element.appendChild(stretching);
            
            // Opzioni per il PDF
            const opt = {
                margin: 10,
                filename: 'scheda_allenamento.pdf',
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { 
                    scale: 2,
                    scrollY: 0,
                    useCORS: true,
                    width: 1000
                },
                jsPDF: { 
                    unit: 'mm', 
                    format: 'a4', 
                    orientation: 'portrait',
                    putOnlyUsedFonts: true
                }
            };
            
            // Genera e scarica il PDF
            html2pdf().set(opt).from(element).save();
            
            // Rimuoviamo l'elemento temporaneo dopo il download
            setTimeout(() => {
                if (element.parentNode) {
                    element.parentNode.removeChild(element);
                }
            }, 1000);
        }
    </script>
</body>
</html>